脚本仅供诸位群友活动末期赶成就或刷作品珠、专武之用，请勿恶意或依赖使用！
脚本仅供诸位群友活动末期赶成就或刷作品珠、专武之用，请勿恶意或依赖使用！
脚本仅供诸位群友活动末期赶成就或刷作品珠、专武之用，请勿恶意或依赖使用！


0、写了个智障Python脚本拯救电脑玩家的游戏体验和肝！
	使用Win32api库按句柄扫色、分析色块获取游戏进程信息并给出回应
		实现战斗结束自动点击再来一关（体力够的话）
		珍藏珠就绪自动进行芳文跳，跳完上AUTO
	支持全屏幕和窗口化游戏！
		后期可能会加自动续表、设置最大游戏次数等功能
		可能会兼容其他系统
		【但是还没太多知识储备，KRF能撑过明年吗？】

#2021.1月初更新补充：
	理论上只要模拟器能将游戏画面开到全屏就可以使用全屏模式
	如果模拟器四面都有边框且颜色一致，理论上可使用窗口模式，但推荐用NOX模拟器（贴吧有教程）
#2021.1月末更新补充：
	210125的更新中提供了读取模拟器句柄进行分析的新版本，目前还不确定兼容性
	目前我搜索到的后台鼠标点击教程都存在一定错误，用Spy++发现了流行的MAKE_LONG加WA_ACTIVE方法最后一个PostMessage()模拟松开左键时键位使用存在错误，空下来写一篇CSDN帮帮后来人罢
	【现实中烦的一比，README中写写抱怨的了，反正没人看得见：大二下真滴好忙，想写一篇百元外设体验VR露营的黑盒教程也没时间，还有这该死的GitHub，文件都传一半给我404，淦！】
	【其实已经可以实现后台操纵，但是这一方面仍在考虑中，挂后台刷游戏似乎让游戏失去了乐趣】
	开放后台句柄点击功能（KRF这个精神强化属实恶心到我了）
#2021.5月末更新补充：
	5月份游戏大更新直接枪毙了NOX模拟器，一方面仍在等待NOX官方回应，另一方面开始着手BlueStacks模拟器脚本的开发
	210525的更新中提供了适应BlueStacks模拟器的脚本


1、使用方法【具体可参考“示例”文件夹中视频】：
	第一次启动：
		运行“Config文件适配程序”，三秒内将模拟器置于屏幕最上层（活动窗口）
		若成功会在源文件夹中出现一个新的“Config”文件
	启动：
		使用模拟器开启KRF，进入将要刷次数的对战，点开脚本（成功跳忙音）
			注意：为避免读不到窗口句柄的问题，请在打开脚本后多点几次模拟器窗口以激活
			注意：由于BlueStacks模拟器自身特性，在窗口缩小到一定比例后会自动模糊画质影响扫色，使用时请确保该窗口不要过小
	停止：
		将光标移至显示器左上角，一段时间后程序自动停止运行（成功跳忙音）
			注意：若出现错误，请重启脚本【如遇死循环，请打开任务管理器关闭脚本】


2、更新：
	2019.09.27:
		更新了小窗口适配，这下可以边刷KRF边补番力！
	2020.01.01:
		使用四分色块法精确查找游戏窗口的左上角及右下角的绝对坐标，避免了手工打点的误差（仅适用于NOX模拟器）
	2020.01.18：
		在次数限制的保护下，去除了持续性检测按钮的等待时间，增加了程序运行的效率【该部分还需要深入研究触发机制】
	2020.01.23：
		更新了代码框架，现在程序可以适配不同的显示尺寸
	2020.01.25：
		忙了一天，让脚本可以读入模拟器窗口的句柄了，现在可以自动获取其尺寸及位置了
		而且现在只要你的模拟器窗口不要太小，无论怎么移动、放缩，脚本都能捕获到你的模拟器并执行操作了
	2021.03.08：
		将扫色函数从Pillow的ImageGrab改为Win32gui的一个方法，实现后台扫色
		将鼠标点击函数内核由简单的Click改为SendMessage\PostMessage，实现后台点击【终于还是公布了最摸鱼的版本，大家谨慎使用】
		【世界上只有一个怪物，就是懒汉 --托·卡莱尔】
	2021.05.25：
		更新BlueStacks模拟器配套版本
	2021.06.26：
		优化代码框架：分离方法与数据，并将主脚本与config适配程序整合


3、联系方式：
	遇到任何形式的使用问题或BUG，请写明情况（最好有报错截图）投至邮箱123059361@qq.com
	感谢您的反馈！